<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="PostPlace">

  <typeAlias alias="PostPlace"
             type="no.studios.atelier.data.DefaultPostPlace"
             />

  <resultMap id="postPlaceResult" class="PostPlace">
    <result property="id" column="id"/>
    <result property="postCode" column="post_code"/>
    <result property="postPlace" column="post_place"/>
  </resultMap>

  <sql id="post-place-field-list">
    id,
    post_code,
    post_place
  </sql>

  <select id="getPostPlaceById"
          parameterClass="integer"
          resultMap="postPlaceResult">
    select <include refid="post-place-field-list"/>
    from post_place
    where id=#id#
  </select>

  <select id="getPostPlaceByCode"
          parameterClass="string"
          resultMap="postPlaceResult">
    select <include refid="post-place-field-list"/>
    from post_place
    where post_code=#postCode#
  </select>

  <select id="getAllPostPlaces" resultMap="postPlaceResult">
    select <include refid="post-place-field-list"/>
    from post_place
  </select>

  <insert id="insertPostPlace" parameterClass="PostPlace">
    insert into post_place
    (
    post_code,
    post_place
    )

    values
    (
    #postCode#,
    #postPlace#
    )

    <selectKey keyProperty="id">
      select max(id) from post_place
    </selectKey>
  </insert>

  <!-- updates a tip postPlace -->
  <update id="updatePostPlace" parameterClass="PostPlace">
    update post_place
    set post_code=#postCode#,
    post_place=#postPlace#
    where id=#id#
  </update>

  <delete id="deletePostPlace" parameterClass="integer">
    delete from post_place where id=#id#
  </delete>

</sqlMap>
