{% extends "base.html" %}
{% block title %}
      <h1>
        Ordrenummer: {{ order["id"] }},
        {{ customer["last_name"] | sn }},
        {{ customer["first_name" ] | sn }}
      </h1>
      <p>
        Opprettet: {{ order["creation_date"] }},
        sist oppdatert: {{ order["updated_date"] | sdn }}
      </p>
{% endblock %}
{% block content %}
      <div class="well">
        <div class="row">
          <div class="col-md-3">Kundenummer: {{ customer["id"] }}</div>
          <div class="col-md-3">Mobil: {{ customer["mobile_phone"] | sn }}</div>
          <div class="col-md-3">Telefon: {{ customer["home_phone"] | sn }}</div>
          <div class="col-md-3">Arbeid: {{ customer["work_phone"] | sn }}</div>
        </div>
        <div class="row">
          <div class="col-md-3">
            Navn:
            <a href="/customer/{{ customer["id"] }}">
              {{ customer["first_name" ] | sn }}
              {{ customer["last_name"] | sn }}
            </a>
          </div>
          <div class="col-md-3">
            Adresse: {{ customer["address"] | sn }}, {{ customer["post_code"] | sn }}
          </div>
          <div class="col-md-3">Født: {{ customer["birth_date"] | sn }}</div>
          <div class="col-md-3">
            Epost:
            <a href="mailto:{{customer["email_address"] | sn }}">
              {{ customer["email_address"] | sn }}
            </a>
          </div>
        </div>
      </div>

      <form action="/order/{{ order['id'] }}"
            method="post"
            class="form-inline">
        <div class="form-group">
          <div class="row">
            <div class="col-md-3">
              <label class="control-label" for="total_amount">Totalt:</label>
              <div class="input-group">
                <span class="input-group-addon">kr</span>
                <input class="form-control"
                       id="total_amount"
                       name="total_amount"
                       value="{{ order['total_amount'] | sn }}"
                       />
                <span class="input-group-addon">,00</span>
              </div>
            </div>
            <div class="col-md-3">
              <label class="control-label" for="paid_amount">Betalt:</label>
              <div class="input-group">
                <span class="input-group-addon">kr</span>
                <input type="text"
                       class="form-control"
                       id="paid_amount"
                       name="paid_amount"
                       value="{{ order['paid_amount'] | sn }}"
                       aria-label="Amount (to the nearest dollar)"/>
                <span class="input-group-addon">,00</span>
              </div>
            </div>
            <div class="col-md-3">
              <label class="control-label" for="rest_amount">Rest:</label>
              <div class="input-group">
                <span class="input-group-addon">kr</span>
                <input class="form-control"
                       value="{{ order['total_amount'] - order['paid_amount'] }}"
                       readonly/>
                <span class="input-group-addon">,00</span>
              </div>
            </div>
            <div class="col-md-3">
              <label class="control-label" for="develivery_date">Leveringsdato:</label>
              <input class="form-control"
                       id="delivery_date"
                       name="delivery_date"
                       value="{{ order['delivery_date'] | sn }}"
                       readonly/>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3" style="margin-top: 1.5em;">
              <button name="update_order" type="submit" class="form-control btn btn-primary">
                Oppdater ordreinformasjon
              </button>
            </div>
          </div>
        </div>
      </form>

      <h2>
        Varer
      </h2>
      <form action="/order/{{ order['id'] }}/item-list"
            method="post" class="form-inline">
        <div class="form-group">
          <label class="control-label" for="product_id">Produkt</label>
          <select id="product_id" name="product_id" class="form-control">
            {% for product in product_list %}
              <option value="{{ product['id'] }}">
                {{ product['name'].decode("utf-8") }}
              </option>
            {% endfor %}
          </select>
          <label class="control-label" for="number_of_items">Antall</label>
          <input
            id="number_of_items"
            name="number_of_items"
            class="form-control span2"
            type="number"
            placeholder="antall"
            value="1"
            />
          <button type="submit" class="btn btn-primary">
            Legg til vare
          </button>
        </div>
      </form>
      {% if order_item_list | length > 0 %}
      <table class="table table-hover" style="margin-top: 2em;">
        <tr>
          <th>Varekjøp #</th>
          <th>Vare</th>
          <th>Antall</th>
          <th>Sum</th>
          <th>Opprettet</th>
          <th></th>
        </tr>
        {% for order_item in order_item_list %}
        <tr>
          <td>
            <a href="/order-item/{{ order_item['id'] }}">
              {{ order_item["id"] }}
            </a>
          </td>
          <td>
            {{ order_item["product_name"] }},
            kr {{ order_item["product_price"]}}
          </td>
          <td>{{ order_item["number_of_items"] }}</td>
          <td>kr {{ order_item["total_amount"] }}</td>
          <td>{{ order_item["creation_date"] }}</td>
          <td>
            <form action="/order-item/{{ order_item['id'] }}/delete" method="post">
              <button type="submit" class="btn btn-danger">
                Slett
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </table>
      {% endif %}
{% endblock %}

